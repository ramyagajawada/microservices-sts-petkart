package com;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import com.controller.PetController;
import com.dao.PetRepository;
import com.pojo.Pet;

@SpringBootTest
@ExtendWith(value = SpringExtension.class)
class Petkart3ApplicationTests {
	@Autowired
	private PetRepository petRepo;
	@Autowired
	private PetController petController;

	@BeforeEach
	public void setUp() {
		Pet pet = new Pet();
		pet.setPetDescription("ramya");
		pet.setPetType("ramyagajawada@gmail.com");
		pet.setPetId("5");
		pet.setPetPrice(12);
		pet.setPetName("ramya");
		
		petRepo.save(pet);
	}

	@AfterEach
	public void cleanUp() {
		petRepo.deleteAll();
	}

	@Test
	void shouldSavePet() {
		// arrange
		Pet pet = new Pet();
		pet.setPetDescription("ramya12");
		pet.setPetType("ramyagajawada55@gmail.com");
		pet.setPetId("9");
		pet.setPetPrice(122);
		pet.setPetName("ramya1234");
//act
		Pet savedPet = petController.savePet(pet);
		// assert
		Assertions.assertThat(savedPet.getPetDescription()).isEqualTo(pet.getPetDescription());
		Assertions.assertThat(savedPet.getPetType()).isEqualTo(pet.getPetType());
		Assertions.assertThat(savedPet.getPetId()).isEqualTo(pet.getPetId());
		Assertions.assertThat(savedPet.getPetPrice()).isEqualTo(pet.getPetPrice());
		Assertions.assertThat(savedPet.getPetName()).isEqualTo(pet.getPetName());
		
	}

	@Test
	void shouldUpdateSavedPet() {
		// arrange
		Pet pet = new Pet();
		pet.setPetDescription("greycolor");
		pet.setPetType("dog");
		pet.setPetId("5");
		
		pet.setPetPrice(122);
		pet.setPetName("pomarian");
//act
		Pet updatedPet = petController.updatePet(pet, "12");
		// assert
		Assertions.assertThat(updatedUser.getEmail()).isEqualTo(pet.getEmail());

	}

	@Test
	void shouldDeleteUser() {
		// arrange
		// act
		boolean deletedUser = petController.deleteUser("12");
		// assert
		Assertions.assertThat(deletedUser).isTrue();
		Assertions.assertThat(petRepo.findAll()).hasSize(0);

	}
	@Test
	void shouldRetriveUser() {
		//act
		User foundUser=petController.findOneUser("12");
		//assert
		Assertions.assertThat(foundUser).isNotNull();
		
	}


	

}
