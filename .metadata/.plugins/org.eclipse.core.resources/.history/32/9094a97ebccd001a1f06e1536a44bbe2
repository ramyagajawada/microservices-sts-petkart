package com;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.AfterEach;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit.jupiter.SpringExtension;

import com.controller.UserController;
import com.dao.UserRepository;
import com.pojos.User;

@SpringBootTest
@ExtendWith(value = SpringExtension.class)
class PetkartApplicationTests {
	@Autowired
	private UserRepository userRepo;
	@Autowired
	private UserController userController;

	@BeforeEach
	public void setUp() {
		User user = new User();
		user.setUserPwd("ramya");
		user.setEmail("ramyagajawada@gmail.com");
		user.setPetId("5");
		user.setUserId("12");
		user.setUserName("ramya");
		user.setConfirmed("confirmed");
		userRepo.save(user);
	}

	@AfterEach
	public void cleanUp() {
		userRepo.deleteAll();
	}

	@Test
	void shouldSaveUser() {
		// arrange
		User user = new User();
		user.setUserPwd("ramya123");
		user.setEmail("ramya@gmail.com");
		user.setPetId("6");
		user.setUserId("123");
		user.setUserName("sushmitha");
		user.setConfirmed("confirmed1");

//act
		User savedUser=userController.saveUser(user);
		//assert
		Assertions.assertThat(savedUser).isEqualTo(user);
	}

}
